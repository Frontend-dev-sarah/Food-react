{"ast":null,"code":"var _jsxFileName = \"/Users/sarah/Documents/Projects/Food/src/store/MealProvider.js\",\n    _s = $RefreshSig$();\n\nimport { useReducer, useEffect, useCallback } from \"react\";\nimport { BASE_URL } from \"../common/constant\";\nimport useHttp from \"../hooks/useHttp\";\nimport { GET_MEALS_FAIL, GET_MEALS_PENDING, GET_MEALS_SUCCESS, POST_MEAL_FAIL, POST_MEAL_PENDING, POST_MEAL_SUCCESS } from \"./actions\";\nimport { mealListInitialState } from \"./initialState\";\nimport MealContext from \"./mealContext\";\nimport mealReducer from \"./mealReducer\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst MealProvider = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [state, dispatch] = useReducer(mealReducer, mealListInitialState);\n  const getMealList = useCallback(async () => {\n    dispatch({\n      type: GET_MEALS_PENDING\n    }); //TODO\n    //try catch trick, async method return a promise, if an error inside a promise,\n    //the promise will be rejected, then not go to catch block, transform to .catch() block inside\n    //useEffect getMealList().catch((e) => {dispatch({\n    //     type: GET_MEALS_FAIL,\n    //     payload: e.message,\n    //   });\n    //})\n\n    try {\n      const response = await fetch(`${BASE_URL}/meals.json`);\n\n      if (!response.ok) {\n        throw new Error(\"Somethig goes wrong !\");\n      }\n\n      const data = await response.json();\n      let formatedMealList = [];\n\n      for (const key in data) {\n        formatedMealList.push(data[key]);\n      }\n\n      dispatch({\n        type: GET_MEALS_SUCCESS,\n        payload: formatedMealList\n      });\n    } catch (error) {\n      //error by default is an object with message property\n      dispatch({\n        type: GET_MEALS_FAIL,\n        payload: error.message\n      });\n    }\n  }, []);\n  useEffect(() => {\n    getMealList();\n  }, [getMealList]);\n\n  const postMealItem = async meals => {\n    dispatch({\n      type: POST_MEAL_PENDING\n    }); // useHttp(BASE_URL,\n    // \"POST\",\n    // meals,\n    // dispatch({ type: POST_MEAL_SUCCESS }),\n    // dispatch({ type: POST_MEAL_FAIL, payload: error })\n    // )\n\n    try {\n      const response = await fetch(BASE_URL, {\n        method: \"POST\",\n        body: JSON.stringify(meals),\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      });\n\n      if (response.ok) {\n        dispatch({\n          type: POST_MEAL_SUCCESS\n        });\n      } else {\n        throw new Error(\"Add meal failed !\");\n      }\n\n      return response;\n    } catch (error) {\n      dispatch({\n        type: POST_MEAL_FAIL,\n        payload: error.message\n      });\n    }\n  };\n\n  const mealContext = {\n    mealList: state.mealList,\n    isLoading: state.isLoading,\n    error: state.error,\n    mealItem: state.mealItem,\n    isPostLoading: state.isPostLoading,\n    errorPost: state.errorPost,\n    getMealList: getMealList,\n    postMealItem: postMealItem\n  };\n  return /*#__PURE__*/_jsxDEV(MealContext.Provider, {\n    value: mealContext,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 5\n  }, this);\n};\n\n_s(MealProvider, \"wrdddd96RIl/lZMnXnHytD23y3I=\");\n\n_c = MealProvider;\nexport default MealProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"MealProvider\");","map":{"version":3,"names":["useReducer","useEffect","useCallback","BASE_URL","useHttp","GET_MEALS_FAIL","GET_MEALS_PENDING","GET_MEALS_SUCCESS","POST_MEAL_FAIL","POST_MEAL_PENDING","POST_MEAL_SUCCESS","mealListInitialState","MealContext","mealReducer","MealProvider","children","state","dispatch","getMealList","type","response","fetch","ok","Error","data","json","formatedMealList","key","push","payload","error","message","postMealItem","meals","method","body","JSON","stringify","headers","mealContext","mealList","isLoading","mealItem","isPostLoading","errorPost"],"sources":["/Users/sarah/Documents/Projects/Food/src/store/MealProvider.js"],"sourcesContent":["import { useReducer, useEffect, useCallback } from \"react\";\nimport { BASE_URL } from \"../common/constant\";\nimport useHttp from \"../hooks/useHttp\";\nimport {\n  GET_MEALS_FAIL,\n  GET_MEALS_PENDING,\n  GET_MEALS_SUCCESS,\n  POST_MEAL_FAIL,\n  POST_MEAL_PENDING,\n  POST_MEAL_SUCCESS,\n} from \"./actions\";\nimport { mealListInitialState } from \"./initialState\";\nimport MealContext from \"./mealContext\";\nimport mealReducer from \"./mealReducer\";\n\nconst MealProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(mealReducer, mealListInitialState);\n\n  const getMealList = useCallback(async () => {\n    dispatch({\n      type: GET_MEALS_PENDING,\n    });\n    //TODO\n    //try catch trick, async method return a promise, if an error inside a promise,\n    //the promise will be rejected, then not go to catch block, transform to .catch() block inside\n    //useEffect getMealList().catch((e) => {dispatch({\n    //     type: GET_MEALS_FAIL,\n    //     payload: e.message,\n    //   });\n    //})\n    try {\n      const response = await fetch(`${BASE_URL}/meals.json`);\n      if (!response.ok) {\n        throw new Error(\"Somethig goes wrong !\");\n      }\n      const data = await response.json();\n      let formatedMealList = [];\n      for (const key in data) {\n        formatedMealList.push(data[key]);\n      }\n      dispatch({\n        type: GET_MEALS_SUCCESS,\n        payload: formatedMealList,\n      });\n    } catch (error) {\n      //error by default is an object with message property\n      dispatch({\n        type: GET_MEALS_FAIL,\n        payload: error.message,\n      });\n    }\n  }, []);\n\n  useEffect(() => {\n    getMealList();\n  }, [getMealList]);\n\n  const postMealItem = async (meals) => {\n    dispatch({ type: POST_MEAL_PENDING });\n    // useHttp(BASE_URL,\n    // \"POST\",\n    // meals,\n    // dispatch({ type: POST_MEAL_SUCCESS }),\n    // dispatch({ type: POST_MEAL_FAIL, payload: error })\n    // )\n    try {\n      const response = await fetch(BASE_URL, {\n        method: \"POST\",\n        body: JSON.stringify(meals),\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n      });\n\n      if (response.ok) {\n        dispatch({ type: POST_MEAL_SUCCESS });\n      } else {\n        throw new Error(\"Add meal failed !\");\n      }\n      return response;\n    } catch (error) {\n      dispatch({ type: POST_MEAL_FAIL, payload: error.message });\n    }\n  };\n\n  const mealContext = {\n    mealList: state.mealList,\n    isLoading: state.isLoading,\n    error: state.error,\n    mealItem: state.mealItem,\n    isPostLoading: state.isPostLoading,\n    errorPost: state.errorPost,\n    getMealList: getMealList,\n    postMealItem: postMealItem,\n  };\n  return (\n    <MealContext.Provider value={mealContext}>{children}</MealContext.Provider>\n  );\n};\n\nexport default MealProvider;\n"],"mappings":";;;AAAA,SAASA,UAAT,EAAqBC,SAArB,EAAgCC,WAAhC,QAAmD,OAAnD;AACA,SAASC,QAAT,QAAyB,oBAAzB;AACA,OAAOC,OAAP,MAAoB,kBAApB;AACA,SACEC,cADF,EAEEC,iBAFF,EAGEC,iBAHF,EAIEC,cAJF,EAKEC,iBALF,EAMEC,iBANF,QAOO,WAPP;AAQA,SAASC,oBAAT,QAAqC,gBAArC;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,OAAOC,WAAP,MAAwB,eAAxB;;;AAEA,MAAMC,YAAY,GAAG,QAAkB;EAAA;;EAAA,IAAjB;IAAEC;EAAF,CAAiB;EACrC,MAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBjB,UAAU,CAACa,WAAD,EAAcF,oBAAd,CAApC;EAEA,MAAMO,WAAW,GAAGhB,WAAW,CAAC,YAAY;IAC1Ce,QAAQ,CAAC;MACPE,IAAI,EAAEb;IADC,CAAD,CAAR,CAD0C,CAI1C;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;IACA,IAAI;MACF,MAAMc,QAAQ,GAAG,MAAMC,KAAK,CAAE,GAAElB,QAAS,aAAb,CAA5B;;MACA,IAAI,CAACiB,QAAQ,CAACE,EAAd,EAAkB;QAChB,MAAM,IAAIC,KAAJ,CAAU,uBAAV,CAAN;MACD;;MACD,MAAMC,IAAI,GAAG,MAAMJ,QAAQ,CAACK,IAAT,EAAnB;MACA,IAAIC,gBAAgB,GAAG,EAAvB;;MACA,KAAK,MAAMC,GAAX,IAAkBH,IAAlB,EAAwB;QACtBE,gBAAgB,CAACE,IAAjB,CAAsBJ,IAAI,CAACG,GAAD,CAA1B;MACD;;MACDV,QAAQ,CAAC;QACPE,IAAI,EAAEZ,iBADC;QAEPsB,OAAO,EAAEH;MAFF,CAAD,CAAR;IAID,CAdD,CAcE,OAAOI,KAAP,EAAc;MACd;MACAb,QAAQ,CAAC;QACPE,IAAI,EAAEd,cADC;QAEPwB,OAAO,EAAEC,KAAK,CAACC;MAFR,CAAD,CAAR;IAID;EACF,CAjC8B,EAiC5B,EAjC4B,CAA/B;EAmCA9B,SAAS,CAAC,MAAM;IACdiB,WAAW;EACZ,CAFQ,EAEN,CAACA,WAAD,CAFM,CAAT;;EAIA,MAAMc,YAAY,GAAG,MAAOC,KAAP,IAAiB;IACpChB,QAAQ,CAAC;MAAEE,IAAI,EAAEV;IAAR,CAAD,CAAR,CADoC,CAEpC;IACA;IACA;IACA;IACA;IACA;;IACA,IAAI;MACF,MAAMW,QAAQ,GAAG,MAAMC,KAAK,CAAClB,QAAD,EAAW;QACrC+B,MAAM,EAAE,MAD6B;QAErCC,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeJ,KAAf,CAF+B;QAGrCK,OAAO,EAAE;UACP,gBAAgB;QADT;MAH4B,CAAX,CAA5B;;MAQA,IAAIlB,QAAQ,CAACE,EAAb,EAAiB;QACfL,QAAQ,CAAC;UAAEE,IAAI,EAAET;QAAR,CAAD,CAAR;MACD,CAFD,MAEO;QACL,MAAM,IAAIa,KAAJ,CAAU,mBAAV,CAAN;MACD;;MACD,OAAOH,QAAP;IACD,CAfD,CAeE,OAAOU,KAAP,EAAc;MACdb,QAAQ,CAAC;QAAEE,IAAI,EAAEX,cAAR;QAAwBqB,OAAO,EAAEC,KAAK,CAACC;MAAvC,CAAD,CAAR;IACD;EACF,CA1BD;;EA4BA,MAAMQ,WAAW,GAAG;IAClBC,QAAQ,EAAExB,KAAK,CAACwB,QADE;IAElBC,SAAS,EAAEzB,KAAK,CAACyB,SAFC;IAGlBX,KAAK,EAAEd,KAAK,CAACc,KAHK;IAIlBY,QAAQ,EAAE1B,KAAK,CAAC0B,QAJE;IAKlBC,aAAa,EAAE3B,KAAK,CAAC2B,aALH;IAMlBC,SAAS,EAAE5B,KAAK,CAAC4B,SANC;IAOlB1B,WAAW,EAAEA,WAPK;IAQlBc,YAAY,EAAEA;EARI,CAApB;EAUA,oBACE,QAAC,WAAD,CAAa,QAAb;IAAsB,KAAK,EAAEO,WAA7B;IAAA,UAA2CxB;EAA3C;IAAA;IAAA;IAAA;EAAA,QADF;AAGD,CAnFD;;GAAMD,Y;;KAAAA,Y;AAqFN,eAAeA,YAAf"},"metadata":{},"sourceType":"module"}